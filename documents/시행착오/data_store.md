# A. ë°ì´í„° ì €ì¥ ì „ëµ

## a. ìš”êµ¬ì‚¬í•­
- **ë‹¤ì–‘í•œ ìƒí’ˆêµ°**: ì •í˜•í™”í•˜ê¸° ì–´ë ¤ìš´ ë¹„ì •í˜• ìƒí’ˆ ë°ì´í„° (MongoDB ì„ íƒ)
- **ëŒ€ìš©ëŸ‰ íŠ¸ë˜í”½**: ë†’ì€ Read ì„±ëŠ¥ê³¼ ìˆ˜í‰ì  í™•ì¥ì´ ìš©ì´í•´ì•¼ í•¨ (MongoDB, Elasticsearch)
- **ì •í™•ì„±**: ì£¼ë¬¸, ì¬ê³  ë“± ë°ì´í„° ì •í•©ì„±ì´ ì¤‘ìš”í•œ ë°ì´í„° (MySQL ì„ íƒ)
- **ê³ ê¸‰ ê²€ìƒ‰**: í•œêµ­ì–´ í˜•íƒœì†Œ ë¶„ì„, ìë™ì™„ì„± ë“± ê³ í’ˆì§ˆ ê²€ìƒ‰ ê¸°ëŠ¥ (Elasticsearch ì„ íƒ)


## b. ë°ì´í„°ë² ì´ìŠ¤ ì„ íƒ ê³¼ì •
### b-1. DB ì„ íƒ ì•Œê³ ë¦¬ì¦˜ 
```mermaid 
graph TD
    A[ì‹œì‘: ë°ì´í„° ì¢…ë¥˜ëŠ”?] --> B{íŠ¸ëœì­ì…˜ì´ ì¤‘ìš”í•œê°€?};
    B -- Yes --> C(ğŸ“¦ **MySQL**<br/>ì£¼ë¬¸, ì¬ê³ , ì¹´í…Œê³ ë¦¬ ë“±<br/>íŠ¸ëœì­ì…˜ ë³´ì¥);
    B -- No --> D{ë°ì´í„° êµ¬ì¡°ê°€ ë¹„ì •í˜•ì ì¸ê°€?};
    D -- Yes --> E(ğŸ“„ **MongoDB**<br/>ìƒí’ˆ ì¹´íƒˆë¡œê·¸, ì‚¬ìš©ì ì •ë³´<br/>ìœ ì—°í•œ ìŠ¤í‚¤ë§ˆ);
    D -- No --> C;
    E --> F{ë¹ ë¥¸ ê²€ìƒ‰/ë¶„ì„ì´ í•„ìš”í•œê°€?};
    F -- Yes --> G(ğŸ” **Elasticsearch**<br/>ìƒí’ˆ ê²€ìƒ‰/ë¡œê·¸ ë¶„ì„<br/>ì—­ì¸ë±ìŠ¤ ê¸°ë°˜);
```





### b-2. RDB vs NOSQL

Q. ë°ì´í„°ê°€ ì–´ë–¨ ë•Œ RDBê°€ ë” ìœ ë¦¬í•˜ê³  NOSQLì´ ë” ìœ ë¦¬í• ê¹Œ?

- case1) RDBì´ ë” ìœ ë¦¬í•œ ê²½ìš°
  - ë°ì´í„°ë¥¼ ì •í˜•í™” í•˜ê³  ì‹¶ì€ ê²½ìš°
  - transaction ê±¸ì–´ì„œ ì •í™•ë„ ë§ì¶°ì•¼ í•˜ëŠ” ë°ì´í„°
- case2) NOSQLì´ ë” ìœ ë¦¬í•œ ê²½ìš°
  - ë°ì´í„°ê°€ ë¹„ì •í˜• ë°ì´í„°ì¸ ê²½ìš°
    - ì‚¬ì‹¤ ì¼ìƒìƒí™œ ì†ì—ëŠ” ì •í˜•í™”ëœ ë°ì´í„°ë³´ë‹¤ ë¹„ì •í˜•í™”ì¸ ë°ì´í„°ê°€ ë§ë‹¤.
    - ex. ì¶”ì²œì‹œìŠ¤í…œì—ì„œ ê³ ê°ì˜ í–‰ë™íŒ¨í„´ì´ ì¸í’‹ìœ¼ë¡œ ë“¤ì–´ê°€ëŠ”ë°, ê³ ê°ì˜ í–‰ë™íŒ¨í„´ì´ ì›Œë‚™ ë‹¤ì–‘í•´ì„œ ëª‡ê°€ì§€ RDB tableì˜ attributeë¡œ ì •í˜•í™” í•˜ê¸° ë§¤ìš° ì–´ë µë‹¤.
  - ì•± íŠ¹ì„±ìƒ íŠ¸ë˜í”½ì´ ê°‘ìê¸° ëª°ë ¤ì„œ ë‹¤ìš´íƒ€ì„ ì—†ì´ ë¬´ì¤‘ë‹¨ìœ¼ë¡œ ìŠ¤ì¼€ì¼ ì—… or ì•„ì›ƒ í•´ì•¼í•˜ëŠ” ê²½ìš°
    - ecommerceëŠ” ì„œë¹„ìŠ¤ ì¤‘ì§€ë˜ëŠ” ìˆœê°„ ê¹¨ì§€ëŠ” ëˆì´ ì–´ë§ˆì–´ë§ˆí•´ì„œ ë¬´ì¤‘ë‹¨ì¸ê²Œ ë§¤ìš° ì¤‘ìš”í•˜ë‹¤. (ì˜ëª»í•´ì„œ ì„œë²„ êº¼ì ¸ì„œ íŒë§¤ìë“¤ì˜ ë§¤ì¶œ íƒ€ê²©ì˜¤ë©´ ì†Œì†¡ ë§ì„ ìˆ˜ë„ ìˆë‹¤.)
    - RDBëŠ” read replicaëŠ” aws-RDSê¸°ì¤€, 6ê°œê¹Œì§€ ë¬´ì¤‘ë‹¨ìœ¼ë¡œ ì¶”ê°€ ê°€ëŠ¥í•œë°, ì´ ì´ìƒì€ ë„ê³  ìŠ¤ì¼€ì¼ì—… í•´ì•¼ í•œë‹¤.
    - ìœ ì €ê°€ ê°‘ìê¸° ëª°ë ¤ì„œ íšŒì›ê°€ì…ì´ í­ì£¼í•´ write heavyê°€ ë˜ëŠ” ê²½ìš°ì—”, write node(master node)ê°€ 1ê°œë¿ì´ê¸°ì—, ë¬´ì¤‘ë‹¨ìœ¼ë¡œ scale outì´ ë¶ˆê°€ëŠ¥í•˜ë‹¤.
    - ê·¸ë˜ì„œ ê¸°ì¡´ì— RDB ì“°ëŠ” ê³³ë“¤ì€ íŠ¸ë˜í”½ ëª°ë¦´ê±¸ ë¯¸ë¦¬ ì˜ˆì¸¡í•´ì„œ ë¯¸ë¦¬ ê³¼ë„í•˜ê²Œ ìŠ¤ì¼€ì¼ ì—… í•´ë†“ê³  ëë‚˜ë©´ ë‹¤ì‹œ ë‚´ë¦¬ëŠ” ì‹ìœ¼ë¡œ ëŒ€ì‘í–ˆëŠ”ë°, nosqlì„ ì“°ë©´ ë¬´ì¤‘ë‹¨ìœ¼ë¡œ ìŠ¤ì¼€ì¼ ì•„ì›ƒ ê°€ëŠ¥í•˜ë‹¤.
  - ëŒ€ê·œëª¨ ë°ì´í„°ì¸ ê²½ìš°, shardingì„ í•´ì•¼í•  ë•Œê°€ ì˜¤ëŠ”ë°, ì´ ë•Œ, nosqlì´ RDBë³´ë‹¤ ë” ìœ ë¦¬í•˜ë‹¤.

### b-3. if NOSQL, mongodb vs elastic search ì„±ëŠ¥ ë¹„êµ

| **ê¸°ì¤€**             | **Elasticsearch**                            | **MongoDB**                          |
| -------------------- | -------------------------------------------- | ------------------------------------ |
| **ê²€ìƒ‰ ìœ í˜•**        | ì „ë¬¸ ê²€ìƒ‰(Full-Text), ìœ ì‚¬ë„ ê²€ìƒ‰, ë‹¤ì¤‘ í•„í„° | ë‹¨ìˆœ í‚¤-ê°’, ë²”ìœ„ ì¿¼ë¦¬                |
| **í‰ê·  ì‘ë‹µ ì‹œê°„**   | 10~50ms (100ë§Œ ê±´ ê¸°ì¤€)                      | 50~200ms (ë™ì¼ ë°ì´í„°)               |
| **ê³ ê¸‰ ê¸°ëŠ¥**        | ì˜¤íƒ€ ë³´ì •, ë™ì˜ì–´ í™•ì¥, ìœ ì‚¬ë„ ìˆœìœ„ ê²°ì •     | ê¸°ë³¸ í…ìŠ¤íŠ¸ ê²€ìƒ‰ (Atlas Search ì œì™¸) |
| **ì¸ë±ìŠ¤ êµ¬ì¡°**      | ì—­ì¸ë±ìŠ¤(Inverted Index)                     | B-Tree ì¸ë±ìŠ¤                        |
| **ë™ì‹œ ê²€ìƒ‰ ì²˜ë¦¬ëŸ‰** | ì´ˆë‹¹ 10,000+ ì¿¼ë¦¬                            | ì´ˆë‹¹ 1,000~5,000 ì¿¼ë¦¬                |

Q. elastic searchê°€ ë” ë¹ ë¥´ë©´ ì™œ êµ³ì´ mongodbì— ìƒí’ˆë°ì´í„° ì €ì¥í• ê¹Œ? ê·¸ëƒ¥ elastic searchì— í•˜ì§€.

A. elastic searchëŠ” transaction ì§€ì›ì„ ì•ˆí•¨. ë”°ë¼ì„œ ë©”ì¸ DBë¡œëŠ” ë¶€ì í•©í•˜ë‹¤.

### b-4. mongodb & elastic searchë¥¼ ì–´ë–»ê²Œ ì¨ì•¼í• ê¹Œ?

read:writeê°€ 9:1 ì´ìƒì¸ ecommerce ë„ë©”ì¸ì˜ ìƒí’ˆë°ì´í„°ëŠ”,\
ì›ë³¸ë°ì´í„°ëŠ” mongodbì— ì €ì¥í•˜ê³ ,\
ê²€ìƒ‰ìš© or ì¶”ì²œìš© í•„ë“œë§Œ ë½‘ì•„ì„œ elatic searchì— sync ë§ì¶”ì. (eventual consistency)

## c. DBë¥¼ ë„ë©”ì¸ ë³„ë¡œ ìª¼ê°œì„œ ì €ì¥í•´ì•¼ í• ê¹Œ?

ë°ì´í„° ê·œëª¨ì— ë”°ë¼ ë‹¬ë¼ì§„ë‹¤.

1. ì†Œê·œëª¨ ë°ì´í„°ë©´ DBí•˜ë‚˜ë¡œ ì“´ë‹¤.
2. ì¤‘ê·œëª¨ ë°ì´í„°ë©´ ìƒí™©ì— ë”°ë¼ ë‹¤ë¥´ë‹¤.
  1. DB scale upì„ í•  ìˆ˜ë¡ ì ì  ë” ë¹„ìš© ëŒ€ë¹„ íš¨ê³¼ê°€ ë¹„íš¨ìœ¨ì ì¸ ì‹œì ì´ ì˜¨ë‹¤,
  2. ë”°ë¼ì„œ ë¹„ì‹¸ê³  ì¢‹ì€ DB 1ê°œ vs ì €ë ´í•œ DB Nê°œì˜ ë¹„ìš©ëŒ€ë¹„ íš¨ê³¼ë¥¼ ì¸¡ì •í•´ì•¼ í•œë‹¤.
3. ëŒ€ìš©ëŸ‰ ë°ì´í„°ë¼ë©´ RDB scale upì—ëŠ” í•œê³„ê°€ ìˆìœ¼ë‹ˆê¹Œ ìª¼ê°œì•¼ í•˜ëŠ”ê²Œ ìœ ë¦¬í•œ ê²½ìš°ê°€ ë§ë‹¤.
  1. ê·¸ëŸ¬ë‚˜ order & user ì²˜ëŸ¼ join í•„ìš”í•œ ê²½ìš°ë¼ë©´ ì™ ë§Œí•˜ë©´ í•˜ë‚˜ì˜ DBì—ì„œ ì“°ëŠ”ê²Œ ìœ ë¦¬í•  ìˆ˜ ìˆë‹¤.


## d. update ì¦‰ì‹œ ì ìš© vs eventual consistency

ì •ë³´ê°€ ëª¨ë“  ëª¨ë“ˆì— ëŒ€í•˜ì—¬ consistent í•´ì•¼í•˜ê³ , up-to-dateí•´ì•¼ í•˜ëŠ” ê²½ìš°ê°€ ìˆë‹¤. (ì˜ˆë¥¼ë“¤ë©´, ëˆê³¼ ê´€ë ¨ëœ ì •ë³´ë“¤)\
ìª¼ê°œì§„ ì—¬ëŸ¬ backend-serverë“¤ì´ ê°™ì€ dbì— ê°™ì€ í…Œì´ë¸”ì„ ì°¸ì¡°í•˜ê²Œ í•˜ê±°ë‚˜,\
ë¡œì§ ë‚´ë¶€ì— grpcí†µì‹ ìœ¼ë¡œ ì¦‰ì‹œ ë‹¤ë¥¸ ë„ë©”ì¸ ëª¨ë“ˆì„ í†µí•´ updateí•˜ê³ , ì‹¤íŒ¨í•˜ë©´ ë¡œì§ ì „ì²´ë¥¼ ì‹¤íŒ¨ ì²˜ë¦¬ í•´ë²„ë¦¬ëŠ” ë°©ì‹ì´ ìˆë‹¤.\
ì„±ëŠ¥ì„ ì•½ê°„ í¬ê¸°í•˜ê³ ì„œë¼ë„, ì •í™•ë„ê°€ í•„ìš”í•˜ë©´ ì´ ë°©ë²•ì„ ì“´ë‹¤.

ì •ë³´ ì—…í…Œì´íŠ¸ê°€ ë°˜ë“œì‹œ up-to-date ì•ˆí•´ë„ ë˜ê³ , ì¢€ ë‚˜ì¤‘ì— ì—¬ìœ ë‚  ë•Œ ì—…ë°ì´íŠ¸ ë˜ë„ ë˜ëŠ” ë°ì´í„°ê°€ ìˆë‹¤.\
ì´ëŸ° ë°ì´í„°ë“¤ì€ consistencyë¥¼ ì•½ê°„ í¬ê¸°í•˜ê³  ì‘ë‹µì„±(availability)ë¥¼ í™•ë³´í•  ìˆ˜ ìˆë‹¤.\
ì˜ˆë¥¼ë“¤ì–´ ecommerceì—ì„œ ìƒí’ˆ ì¹´íƒˆë¡œê·¸ì˜ ì›ë³¸ ì •ë³´ëŠ” mongodbì— ì €ì¥í•˜ê³ , elastic searchì— ìºì‹±í•˜ëŠ” ê²½ìš°,\
ë°ì´í„°ë¥¼ 2ê³³ì— ë‚˜ëˆ ì„œ ì €ì¥í•˜ê¸° ë•Œë¬¸ì—, ë‘ ë°ì´í„°ì˜ ì •í•©ì„±ì´ ì•ˆë§ì„ ë•Œë„ ìˆì„ ìˆ˜ ìˆì§€ë§Œ,\
elastic search ì„œë²„ê°€ ë‹¤ìš´ë˜ë„ mongodbì—ì„œ ê°€ì ¸ì˜¬ ìˆ˜ ìˆê¸° ë•Œë¬¸ì—, consistencyê°€ ë–¨ì–´ì ¸ë„ availabilityì„ ë†’í ìˆ˜ ìˆë‹¤.


## e. ìƒí’ˆ ë°ì´í„°ëŠ” ì–´ëŠ DBì— ì–´ëŠ ë°ì´í„° êµ¬ì¡°ë¡œ ì €ì¥í•˜ì§€?

ë³´í†µ RDBì— ìƒí’ˆë°ì´í„°ë¥¼ ë„£ê³  ê´€ë¦¬í•œë‹¤ê³  ìƒê°í•˜ëŠ”ë°,\
íŒŒëŠ” ìƒí’ˆ ì¢…ë¥˜ê°€ ëª‡ê°œ ì•ˆë˜ë©´, í…Œì´ë¸” ì»¬ëŸ¼ ì •ì˜í•˜ê¸°ê°€ ìš©ì´í•˜ì§€ë§Œ,\
ì¿ íŒ¡ê°™ì´ ìƒí’ˆì¢…ë¥˜ê°€ ë§¤ìš° ë‹¤ì–‘í•˜ë©´ nosqlì— ë°€ì–´ë„£ê³  íŒŒì‹±í•´ì„œ ì“°ëŠ”ê²Œ ë‚«ë‹¤.

ì˜ˆë¥¼ë“¤ì–´, ì‹ ë°œ ì „ë¬¸ ì‡¼í•‘ëª°ì˜ ê²½ìš° í…Œì´ë¸” ì»¬ëŸ¼ ì¢…ë¥˜ê°€ ì•„ë¬´ë¦¬ ë‹¤ì–‘í•´ë´¤ì ëª‡ì‹­ê°œ ì´ë‚´ë¡œ íŠ¹ì •ì§€ì„ ìˆ˜ ìˆë‹¤.

í•˜ì§€ë§Œ ì‡¼í•‘ëª°ì—ì„œ ì‹ ë°œ, ìŠ¤ë§ˆíŠ¸í°, ì±„ì†Œë¥¼ íŒë‹¤ê³  í•  ê²½ìš°,\
ì´ 3ì¢…ë¥˜ ìƒí’ˆì— ëª¨ë‘ í•´ë‹¹ë˜ëŠ” ì»¬ëŸ¼ì„ ë§Œë“¤ë©´,\
nullê°’ì´ ë“¤ì–´ê°€ëŠ” ì»¬ëŸ¼ì´ ë„ˆë¬´ ë§ì´ ìƒê²¨ì„œ,\
ë©”ëª¨ë¦¬ ìš©ëŸ‰ ë‚­ë¹„ê°€ ë„ˆë¬´ ì‹¬í•´ì§„ë‹¤.

ì´ëŸ´ ë•Œ ë„ë©”ì¸ì„ ì˜ ë‚˜ëˆ„ëŠ” ë…¸í•˜ìš°ê°€ í•„ìš”í•´ì§€ê³ ,\
ì–´ì„¤í”„ê²Œ ë‚˜ëˆ„ë©´ ecommerceì—ì„œ ë‹¤ë¤„ì§€ëŠ” ëª¨ë“  ìƒí’ˆì„ ì •í™•íˆ ë¶„ë¥˜í•  ë•Œ ë¬¸ì œê°€ ìƒê¸´ë‹¤.

---

ìƒí’ˆì„ ì¶”ê°€í•  ë•Œ, ìƒˆë¡œìš´ í•„ë“œë¥¼ í•˜ë‚˜ ì¶”ê°€í•´ì•¼ í•˜ëŠ” ìƒí™©ì´ë¼ ì¹˜ì.

RDBë©´ ìŠ¤í‚¤ë§ˆ ë³€ê²½í•´ì•¼ í•˜ê³  migration í•´ì•¼í•˜ëŠ”ê²Œ ë¶€ë‹´ìŠ¤ëŸ¬ìš¸ ìˆ˜ ìˆëŠ” ë°˜ë©´,\
Nosqlì€ ë¹„êµì  ììœ ë¡­ë‹¤.

---

ì¿ íŒ¡ê°™ì€ ëŒ€ê·œëª¨ ì‡¼í•‘ëª°ì€ ë“±ë¡ëœ ìƒí’ˆ ê°¯ìˆ˜ë§Œ 100ë§Œê°œ ì´ìƒì´ë¼ê³  í•˜ë©´,\
ë°ì´í„°ë¥¼ ìª¼ê°œì„œ ì—¬ëŸ¬ DBì— ë‚˜ëˆ ì„œ ì €ì¥í•˜ëŠ” ìƒ¤ë”©ì„ ì„ íƒí•˜ëŠ” ê²½ìš°ê°€ ìˆëŠ”ë°,\
RDBë³´ë‹¤ nosqlì´ ìƒ¤ë”©ì— ë” ìœ ë¦¬í•˜ë‹¤.

## f. ê³„ì¸µí™”ëœ ìƒí’ˆ ì¹´í…Œê³ ë¦¬ ì •ë³´ëŠ” ì–´ë””ì— ì €ì¥í•˜ëŠ”ê²Œ ì¢‹ì„ê¹Œ?
ê³„ì¸µí™”ëœ ì¹´í…Œê³ ë¦¬ëŠ” ì´ëŸ° ëœ»ì´ë‹¤.

path ì»¬ëŸ¼ì˜ ì˜ˆì‹œ)
- "ì „ìì œí’ˆ" -> ID: 1, path: "1"
- "ì»´í“¨í„°" -> ID: 4, path: "1/4"
- "ë…¸íŠ¸ë¶" -> ID: 28, path: "1/4/28"
- "ê²Œì´ë° ë…¸íŠ¸ë¶" -> ID: 56, path: "1/4/28/56"

ì´ë ‡ê²Œ í•˜ë©´ "path LIKE '1/4/%'" ê°™ì€ ì¿¼ë¦¬ë¡œ ì»´í“¨í„° ì¹´í…Œê³ ë¦¬ ì•„ë˜ ëª¨ë“  í•˜ìœ„ ì¹´í…Œê³ ë¦¬ë¥¼ í•œë°©ì— ê°€ì ¸ì˜¬ ìˆ˜ ìˆë‹¤. ì¬ê·€ ì¿¼ë¦¬ ì•ˆ ì¨ë„ ëœë‹¤.

ë˜ "ë…¸íŠ¸ë¶"ì˜ ëª¨ë“  ìƒìœ„ ì¹´í…Œê³ ë¦¬ ì°¾ìœ¼ë ¤ë©´ path("1/4/28")ë¥¼ '/'ë¡œ ìª¼ê°œì„œ ID 1, 4ë¥¼ ë°”ë¡œ ì•Œ ìˆ˜ ìˆë‹¤.

nosqlì— ê³„ì¸µí™”ëœ ìƒí’ˆ ì¹´í…Œê³ ë¦¬ ì •ë³´ëŠ” ì´ëŸ°ì‹ìœ¼ë¡œ ì €ì¥ëœë‹¤.
```sql
// ì¹´í…Œê³ ë¦¬ ì»¬ë ‰ì…˜
db.categories.insertMany([
  { _id: 1, name: "ì „ìì œí’ˆ", path: "1", level: 0 },
  { _id: 4, name: "ì»´í“¨í„°", path: "1/4", level: 1 },
  { _id: 28, name: "ë…¸íŠ¸ë¶", path: "1/4/28", level: 2 }
]);

// ìƒí’ˆ ì»¬ë ‰ì…˜
db.products.insertOne({
  _id: "P123",
  name: "ê²Œì´ë° ë…¸íŠ¸ë¶",
  category_ids: [1, 4, 28],  // ëª¨ë“  ìƒìœ„ ì¹´í…Œê³ ë¦¬ ID ë°°ì—´
  category_paths: ["1", "1/4", "1/4/28"] // ê³„ì¸µ ê²½ë¡œ ì €ì¥
});

// ì¸ë±ìŠ¤ ìƒì„±
db.products.createIndex({ "category_paths": 1 });

// ì¿¼ë¦¬
// 'ì»´í“¨í„°(4)'ì™€ ëª¨ë“  í•˜ìœ„ ì¹´í…Œê³ ë¦¬ ìƒí’ˆ ì¡°íšŒ
db.products.find({
  category_paths: { $regex: /^1\/4/ }
});
```

ì£¼ì˜í•  ì ì€, regex íŒ¨í„´ì´ ê³ ì •ì´ëƒ, ë¶€ë¶„ê³ ì •ì´ëƒ, ë¹„ê³ ì •ì´ëƒì— ë”°ë¼ì„œ ì¸ë±ìŠ¤ë¥¼ íƒ€ê³  ì•ˆíƒ€ê³ ê°€ ì •í•´ì§„ë‹¤ëŠ” ê²ƒì´ë‹¤.

1. `/^1\/4/` ì€ ê³ ì • íŒ¨í„´ì´ë¼ ì¸ë±ìŠ¤ íƒ„ë‹¤.
  - `1/4`ë¡œ ì‹œì‘í•˜ëŠ” ëª¨ë“  ê²½ë¡œë¥¼ ë²”ìœ„ìŠ¤ìº” í•œë‹¤. (IXSCAN)
  - ì¶”ê°€ í•„í„°ë§ ì—†ì´ 1/4 ì‹œì‘ì ì„ ì°¾ê³ , ê±°ê¸°ì— ì—°ê²°ëœ ëª¨ë“  leaf nodeë“¤ì„ ë°˜í™˜í•œë‹¤.
  - ì˜ˆ: 1/4, 1/4/28, 1/4/28/56 ë“±
  - MySQLì˜ LIKE '1/4%'ì™€ ìœ ì‚¬
2. `/^1\/4(\/|$)/` ì€ ë¶€ë¶„ ê³ ì • íŒ¨í„´ì´ë¼ ì¸ë±ìŠ¤ë¥¼ ë¶€ë¶„ì ìœ¼ë¡œë§Œ íƒ„ë‹¤.
  - 1/4ê¹Œì§€ ê³ ì •ì´ì—ˆë‹¤ê°€ ê·¸ ì´í›„ë¡œëŠ” ì¡°ê±´ì‹ì´ ë¶™ì€ ë¶€ë¶„ ê³ ì • íŒ¨í„´ì€ ì¸ë±ìŠ¤ë¥¼ ë¶€ë¶„ì ìœ¼ë¡œë§Œ í™œìš©í•´ì„œ íš¨ìœ¨ì´ ë–¨ì–´ì§„ë‹¤ê³  í•œë‹¤.
  - ì¸ë±ìŠ¤ì—ì„œ 1/4ë¡œ ì‹œì‘í•˜ëŠ” ëª¨ë“  ê²½ë¡œ ê²€ìƒ‰ (IXSCAN)í•œ í›„, ë©”ëª¨ë¦¬ì—ì„œ `(\/|$)` ì¡°ê±´ì„ ì¶”ê°€ë¡œ í•„í„°ë§.
  - ë”°ë¼ì„œ regexì§¤ ë•Œ ì¡°ê¸ˆ ì‹ ê²½ì¨ì•¼ í•œë‹¤.
3. `/1\/4/` ì€ ë¹„ê³ ì • íŒ¨í„´ì´ë¼ ì¸ë±ìŠ¤ë¥¼ ì•ˆíƒ€ì„œ ëŠë¦¬ë‹¤.
  - 1/4ê°€ ë¬¸ìì—´ ì¤‘ê°„ì— ìœ„ì¹˜í•  ìˆ˜ ìˆìŒ
  - ë”°ë¼ì„œ ì•ì— ^ì„ ë¶™ì—¬ì„œ ì™¼ìª½ë¶€í„° ì‹œì‘í•œë‹¤ëŠ”ê±¸ ê³ ì •ì‹œì¼œë†”ì•¼ ì¸ë±ìŠ¤ë¥¼ íƒ„ë‹¤.


ê·¸ëŸ¬ë©´ ì‹¤ì œ ë°ì´í„°ëŠ” ì–´ë–»ê²Œ ë³´ì¼ê¹Œ?

```sql
// ì¹´í…Œê³ ë¦¬ ì»¬ë ‰ì…˜ ì˜ˆì‹œ
[
  {
    "_id": 1,
    "name": "ì „ìì œí’ˆ",
    "parent_id": null,
    "path": "1",
    "level": 0
  },
  {
    "_id": 2,
    "name": "ì»´í“¨í„°",
    "parent_id": 1,
    "path": "1/2",
    "level": 1
  },
  {
    "_id": 4,
    "name": "ë…¸íŠ¸ë¶",
    "parent_id": 2,
    "path": "1/2/4",
    "level": 2
  },
  {
    "_id": 56,
    "name": "ê²Œì´ë° ë…¸íŠ¸ë¶",
    "parent_id": 4,
    "path": "1/2/4/56",
    "level": 3
  }
]

// categories ì»¬ë ‰ì…˜ ì¸ë±ìŠ¤
db.categories.createIndex({ "path": 1 });
db.categories.createIndex({ "level": 1 });
db.categories.createIndex({ "parent_id": 1 });
```

```sql
// ìƒí’ˆ ì»¬ë ‰ì…˜ ì˜ˆì‹œ
{
  "_id": ObjectId("65c3e7a1d8f5e11a2b3c4d5e"),
  "title": "Apple 2025 MacBook Pro",
  "description": "ìµœì‹  Apple MacBook Pro, M3 Max ì¹©, 16ì¸ì¹˜ Liquid Retina XDR ë””ìŠ¤í”Œë ˆì´",
  "brand": "Apple",
  "model": "MUW73LL/A",
  "sku": "MBP-16-M3-MAX",
  "upc": "195949185694",
  "color": "Space Gray",

  "category_ids": [1, 2, 4],
  "primary_category_id": 4,
  "category_breadcrumbs": ["ì „ìì œí’ˆ", "ì»´í“¨í„°", "ë…¸íŠ¸ë¶"],
  "category_path", "1/4/7",
  "category_level" 3,

  "price": {
    "amount": 3499.99,
    "currency": "USD"
  },
  "stock": 100,
  "stock_reserved": 0,  // SAGA rollbackì„ ìœ„í•œ ì˜ˆì•½ ì¬ê³ ëŸ‰
  "weight": {
    "value": 4.8,
    "unit": "POUND"
  },
  "dimensions": {
    "length": 14.01,
    "width": 9.77,
    "height": 0.66,
    "unit": "INCH"
  },
  "attributes": {
    "processor": "M3 Max",
    "ram": "32GB",
    "storage": "1TB SSD",
    "screen_size": "16 inch",
    "resolution": "3456 x 2234"
  },
  "variants": [
    {
      "id": "variant1",
      "sku": "MBP-16-M3-MAX-SG-32GB-1TB",
      "color": "Space Gray",
      "storage": "1TB",
      "price": {
        "amount": 3499.99,
        "currency": "USD"
      },
      "attributes": {
        "processor": "M3 Max",
        "ram": "32GB"
      },
      "inventory": 50
    },
    {
      "id": "variant2",
      "sku": "MBP-16-M3-MAX-SIL-32GB-1TB",
      "color": "Silver",
      "storage": "1TB",
      "price": {
        "amount": 3499.99,
        "currency": "USD"
      },
      "attributes": {
        "processor": "M3 Max",
        "ram": "32GB"
      },
      "inventory": 35
    }
  ],
  "images": [
    {
      "url": "https://example.com/macbook-pro-1.jpg",
      "main": true
    },
    {
      "url": "https://example.com/macbook-pro-2.jpg",
      "main": false
    }
  ],
  "created_at": "2025-04-30T10:15:30.123Z",
  "updated_at": "2025-04-30T10:15:30.123Z"
}

// ìƒí’ˆ ì»¬ë ‰ì…˜ ì¸ë±ìŠ¤
db.products.createIndex({ "category_ids": 1 });  // ì¹´í…Œê³ ë¦¬ IDë¡œ ì¡°íšŒ
db.products.createIndex({ "primary_category_id": 1 });  // ì£¼ ì¹´í…Œê³ ë¦¬ë¡œ ì¡°íšŒ
db.products.createIndex({ "category_path": 1 });  // ê³„ì¸µ êµ¬ì¡° ì¿¼ë¦¬ ("1/2/%" í˜•íƒœ)
db.products.createIndex({ "category_level": 1 });  // íŠ¹ì • ê¹Šì´ ì¹´í…Œê³ ë¦¬ ì¡°íšŒ


// íŠ¹ì • ì¹´í…Œê³ ë¦¬ì— ì†í•œ ìƒí’ˆ ì°¾ê¸°
db.products.find({ category_ids: 4 });

// ì£¼ ì¹´í…Œê³ ë¦¬ê°€ ë…¸íŠ¸ë¶ì¸ ìƒí’ˆ
db.products.find({ primary_category_id: 4 });

// ì»´í“¨í„° ì¹´í…Œê³ ë¦¬ì™€ ê·¸ í•˜ìœ„ ëª¨ë“  ì¹´í…Œê³ ë¦¬ ìƒí’ˆ
db.products.find({ category_path: /^1\/2/ });

// ê¹Šì´ê°€ 2ì¸ ì¹´í…Œê³ ë¦¬ ìƒí’ˆ (ì˜ˆ: ë…¸íŠ¸ë¶, ë°ìŠ¤í¬íƒ‘ ë“±)
db.products.find({ category_level: 2 });
```

## g. architecture 

```mermaid
graph TD
    subgraph "Data Types"
        A("<b>ì£¼ë¬¸/ì¬ê³ </b><br/>(Transactional)")
        B("<b>ìƒí’ˆ/ìœ ì €</b><br/>(Document)")
        C("<b>ë¡œê·¸/ê²€ìƒ‰</b><br/>(Search/Log)")
    end

    subgraph "Databases (Polyglot Persistence)"
        D["ğŸ“¦ MySQL (ACID ë³´ì¥)"]
        E["ğŸ“„ MongoDB (ìœ ì—°ì„±, í™•ì¥ì„±)"]
        F["ğŸ” Elasticsearch (ê²€ìƒ‰ ì†ë„)"]
    end

    A -- "ê°•ë ¥í•œ ì •í•©ì„± ìš”êµ¬" --> D
    B -- "ìœ ì—°í•œ ìŠ¤í‚¤ë§ˆ ìš”êµ¬" --> E
    E -- "ì‹¤ì‹œê°„ ë™ê¸°í™” (for Search)" --> F
    C -- "ì‹¤ì‹œê°„ ë¶„ì„/ê²€ìƒ‰ ìš”êµ¬" --> F
``` 

